#! /usr/bin/env node

/* eslint no-console: 0 */
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("airbnb-js-shims");

var _semver = _interopRequireDefault(require("semver"));

var _npmRun = _interopRequireDefault(require("npm-run"));

var _getAdapterForReactVersion = _interopRequireDefault(require("./getAdapterForReactVersion"));

var reactEnv = process.env.REACT;
var reactArg = process.argv[2];

if (reactEnv && !_semver["default"].validRange(reactEnv)) {
  throw new Error('REACT environment variable is not a valid semver range');
}

if (reactArg && !_semver["default"].validRange(reactArg)) {
  throw new Error('Argument supplied to enzyme-adapter-react-install is not a valid semver range');
}

var reactVersion = reactEnv || reactArg;

if (!_semver["default"].intersects(reactVersion, '>=0.13')) {
  throw new Error('semver range is not valid. Please provide a valid semver range as an argument or environment variable.');
}

console.log('Cleaning up React and related packages...');
var commands = ['npm uninstall --no-save react-dom react-test-renderer react-addons-test-utils enzyme-adapter-react-14 enzyme-adapter-react-15.4 enzyme-adapter-react-15 enzyme-adapter-react-16', 'rimraf node_modules/react-test-renderer node_modules/react', 'npm prune'];

try {
  commands.forEach(function (cmd) {
    _npmRun["default"].execSync(cmd, {
      stdio: 'inherit'
    });
  });
} catch (e) {
  console.error('An uninstallation failed');
  console.error(e, e.stack);
  process.exit(1);
}

console.log("Installing React@".concat(reactVersion, " and related packages..."));
var adapterName = (0, _getAdapterForReactVersion["default"])(reactVersion);

try {
  _npmRun["default"].execSync("install-peerdeps -S ".concat(adapterName), {
    stdio: 'inherit'
  });
} catch (e) {
  console.error('An installation failed');
  console.error(e, e.stack);
  process.exit(666);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbnp5bWUtYWRhcHRlci1yZWFjdC1pbnN0YWxsLmpzIl0sIm5hbWVzIjpbInJlYWN0RW52IiwicHJvY2VzcyIsImVudiIsIlJFQUNUIiwicmVhY3RBcmciLCJhcmd2Iiwic2VtdmVyIiwidmFsaWRSYW5nZSIsIkVycm9yIiwicmVhY3RWZXJzaW9uIiwiaW50ZXJzZWN0cyIsImNvbnNvbGUiLCJsb2ciLCJjb21tYW5kcyIsImZvckVhY2giLCJjbWQiLCJucG1SdW4iLCJleGVjU3luYyIsInN0ZGlvIiwiZSIsImVycm9yIiwic3RhY2siLCJleGl0IiwiYWRhcHRlck5hbWUiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBOzs7OztBQUVBOztBQUVBOztBQUNBOztBQUNBOztBQUVBLElBQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLEtBQTdCO0FBQ0EsSUFBTUMsUUFBUSxHQUFHSCxPQUFPLENBQUNJLElBQVIsQ0FBYSxDQUFiLENBQWpCOztBQUVBLElBQUlMLFFBQVEsSUFBSSxDQUFDTSxtQkFBT0MsVUFBUCxDQUFrQlAsUUFBbEIsQ0FBakIsRUFBOEM7QUFDNUMsUUFBTSxJQUFJUSxLQUFKLENBQVUsd0RBQVYsQ0FBTjtBQUNEOztBQUVELElBQUlKLFFBQVEsSUFBSSxDQUFDRSxtQkFBT0MsVUFBUCxDQUFrQkgsUUFBbEIsQ0FBakIsRUFBOEM7QUFDNUMsUUFBTSxJQUFJSSxLQUFKLENBQVUsK0VBQVYsQ0FBTjtBQUNEOztBQUVELElBQU1DLFlBQVksR0FBR1QsUUFBUSxJQUFJSSxRQUFqQzs7QUFFQSxJQUFJLENBQUNFLG1CQUFPSSxVQUFQLENBQWtCRCxZQUFsQixFQUFnQyxRQUFoQyxDQUFMLEVBQWdEO0FBQzlDLFFBQU0sSUFBSUQsS0FBSixDQUFVLHdHQUFWLENBQU47QUFDRDs7QUFFREcsT0FBTyxDQUFDQyxHQUFSLENBQVksMkNBQVo7QUFDQSxJQUFNQyxRQUFRLEdBQUcsQ0FDZixpTEFEZSxFQUVmLDREQUZlLEVBR2YsV0FIZSxDQUFqQjs7QUFNQSxJQUFJO0FBQ0ZBLEVBQUFBLFFBQVEsQ0FBQ0MsT0FBVCxDQUFpQixVQUFDQyxHQUFELEVBQVM7QUFDeEJDLHVCQUFPQyxRQUFQLENBQWdCRixHQUFoQixFQUFxQjtBQUFFRyxNQUFBQSxLQUFLLEVBQUU7QUFBVCxLQUFyQjtBQUNELEdBRkQ7QUFHRCxDQUpELENBSUUsT0FBT0MsQ0FBUCxFQUFVO0FBQ1ZSLEVBQUFBLE9BQU8sQ0FBQ1MsS0FBUixDQUFjLDBCQUFkO0FBQ0FULEVBQUFBLE9BQU8sQ0FBQ1MsS0FBUixDQUFjRCxDQUFkLEVBQWlCQSxDQUFDLENBQUNFLEtBQW5CO0FBQ0FwQixFQUFBQSxPQUFPLENBQUNxQixJQUFSLENBQWEsQ0FBYjtBQUNEOztBQUVEWCxPQUFPLENBQUNDLEdBQVIsNEJBQWdDSCxZQUFoQztBQUNBLElBQU1jLFdBQVcsR0FBRywyQ0FBMEJkLFlBQTFCLENBQXBCOztBQUVBLElBQUk7QUFDRk8scUJBQU9DLFFBQVAsK0JBQXVDTSxXQUF2QyxHQUFzRDtBQUFFTCxJQUFBQSxLQUFLLEVBQUU7QUFBVCxHQUF0RDtBQUNELENBRkQsQ0FFRSxPQUFPQyxDQUFQLEVBQVU7QUFDVlIsRUFBQUEsT0FBTyxDQUFDUyxLQUFSLENBQWMsd0JBQWQ7QUFDQVQsRUFBQUEsT0FBTyxDQUFDUyxLQUFSLENBQWNELENBQWQsRUFBaUJBLENBQUMsQ0FBQ0UsS0FBbkI7QUFDQXBCLEVBQUFBLE9BQU8sQ0FBQ3FCLElBQVIsQ0FBYSxHQUFiO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIjISAvdXNyL2Jpbi9lbnYgbm9kZVxuLyogZXNsaW50IG5vLWNvbnNvbGU6IDAgKi9cblxuaW1wb3J0ICdhaXJibmItanMtc2hpbXMnO1xuXG5pbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7XG5pbXBvcnQgbnBtUnVuIGZyb20gJ25wbS1ydW4nO1xuaW1wb3J0IGdldEFkYXB0ZXJGb3JSZWFjdFZlcnNpb24gZnJvbSAnLi9nZXRBZGFwdGVyRm9yUmVhY3RWZXJzaW9uJztcblxuY29uc3QgcmVhY3RFbnYgPSBwcm9jZXNzLmVudi5SRUFDVDtcbmNvbnN0IHJlYWN0QXJnID0gcHJvY2Vzcy5hcmd2WzJdO1xuXG5pZiAocmVhY3RFbnYgJiYgIXNlbXZlci52YWxpZFJhbmdlKHJlYWN0RW52KSkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ1JFQUNUIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG5vdCBhIHZhbGlkIHNlbXZlciByYW5nZScpO1xufVxuXG5pZiAocmVhY3RBcmcgJiYgIXNlbXZlci52YWxpZFJhbmdlKHJlYWN0QXJnKSkge1xuICB0aHJvdyBuZXcgRXJyb3IoJ0FyZ3VtZW50IHN1cHBsaWVkIHRvIGVuenltZS1hZGFwdGVyLXJlYWN0LWluc3RhbGwgaXMgbm90IGEgdmFsaWQgc2VtdmVyIHJhbmdlJyk7XG59XG5cbmNvbnN0IHJlYWN0VmVyc2lvbiA9IHJlYWN0RW52IHx8IHJlYWN0QXJnO1xuXG5pZiAoIXNlbXZlci5pbnRlcnNlY3RzKHJlYWN0VmVyc2lvbiwgJz49MC4xMycpKSB7XG4gIHRocm93IG5ldyBFcnJvcignc2VtdmVyIHJhbmdlIGlzIG5vdCB2YWxpZC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBzZW12ZXIgcmFuZ2UgYXMgYW4gYXJndW1lbnQgb3IgZW52aXJvbm1lbnQgdmFyaWFibGUuJyk7XG59XG5cbmNvbnNvbGUubG9nKCdDbGVhbmluZyB1cCBSZWFjdCBhbmQgcmVsYXRlZCBwYWNrYWdlcy4uLicpO1xuY29uc3QgY29tbWFuZHMgPSBbXG4gICducG0gdW5pbnN0YWxsIC0tbm8tc2F2ZSByZWFjdC1kb20gcmVhY3QtdGVzdC1yZW5kZXJlciByZWFjdC1hZGRvbnMtdGVzdC11dGlscyBlbnp5bWUtYWRhcHRlci1yZWFjdC0xNCBlbnp5bWUtYWRhcHRlci1yZWFjdC0xNS40IGVuenltZS1hZGFwdGVyLXJlYWN0LTE1IGVuenltZS1hZGFwdGVyLXJlYWN0LTE2JyxcbiAgJ3JpbXJhZiBub2RlX21vZHVsZXMvcmVhY3QtdGVzdC1yZW5kZXJlciBub2RlX21vZHVsZXMvcmVhY3QnLFxuICAnbnBtIHBydW5lJyxcbl07XG5cbnRyeSB7XG4gIGNvbW1hbmRzLmZvckVhY2goKGNtZCkgPT4ge1xuICAgIG5wbVJ1bi5leGVjU3luYyhjbWQsIHsgc3RkaW86ICdpbmhlcml0JyB9KTtcbiAgfSk7XG59IGNhdGNoIChlKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ0FuIHVuaW5zdGFsbGF0aW9uIGZhaWxlZCcpO1xuICBjb25zb2xlLmVycm9yKGUsIGUuc3RhY2spO1xuICBwcm9jZXNzLmV4aXQoMSk7XG59XG5cbmNvbnNvbGUubG9nKGBJbnN0YWxsaW5nIFJlYWN0QCR7cmVhY3RWZXJzaW9ufSBhbmQgcmVsYXRlZCBwYWNrYWdlcy4uLmApO1xuY29uc3QgYWRhcHRlck5hbWUgPSBnZXRBZGFwdGVyRm9yUmVhY3RWZXJzaW9uKHJlYWN0VmVyc2lvbik7XG5cbnRyeSB7XG4gIG5wbVJ1bi5leGVjU3luYyhgaW5zdGFsbC1wZWVyZGVwcyAtUyAke2FkYXB0ZXJOYW1lfWAsIHsgc3RkaW86ICdpbmhlcml0JyB9KTtcbn0gY2F0Y2ggKGUpIHtcbiAgY29uc29sZS5lcnJvcignQW4gaW5zdGFsbGF0aW9uIGZhaWxlZCcpO1xuICBjb25zb2xlLmVycm9yKGUsIGUuc3RhY2spO1xuICBwcm9jZXNzLmV4aXQoNjY2KTtcbn1cbiJdfQ==
//# sourceMappingURL=enzyme-adapter-react-install.js.map