{"version":3,"sources":["../src/enzyme-adapter-react-install.js"],"names":["reactEnv","process","env","REACT","reactArg","argv","semver","validRange","Error","reactVersion","intersects","console","log","commands","forEach","cmd","npmRun","execSync","stdio","e","error","stack","exit","adapterName"],"mappings":"AAAA;;AACA;;;;;AAEA;;AAEA;;AACA;;AACA;;AAEA,IAAMA,QAAQ,GAAGC,OAAO,CAACC,GAAR,CAAYC,KAA7B;AACA,IAAMC,QAAQ,GAAGH,OAAO,CAACI,IAAR,CAAa,CAAb,CAAjB;;AAEA,IAAIL,QAAQ,IAAI,CAACM,mBAAOC,UAAP,CAAkBP,QAAlB,CAAjB,EAA8C;AAC5C,QAAM,IAAIQ,KAAJ,CAAU,wDAAV,CAAN;AACD;;AAED,IAAIJ,QAAQ,IAAI,CAACE,mBAAOC,UAAP,CAAkBH,QAAlB,CAAjB,EAA8C;AAC5C,QAAM,IAAII,KAAJ,CAAU,+EAAV,CAAN;AACD;;AAED,IAAMC,YAAY,GAAGT,QAAQ,IAAII,QAAjC;;AAEA,IAAI,CAACE,mBAAOI,UAAP,CAAkBD,YAAlB,EAAgC,QAAhC,CAAL,EAAgD;AAC9C,QAAM,IAAID,KAAJ,CAAU,wGAAV,CAAN;AACD;;AAEDG,OAAO,CAACC,GAAR,CAAY,2CAAZ;AACA,IAAMC,QAAQ,GAAG,CACf,iLADe,EAEf,4DAFe,EAGf,WAHe,CAAjB;;AAMA,IAAI;AACFA,EAAAA,QAAQ,CAACC,OAAT,CAAiB,UAACC,GAAD,EAAS;AACxBC,uBAAOC,QAAP,CAAgBF,GAAhB,EAAqB;AAAEG,MAAAA,KAAK,EAAE;AAAT,KAArB;AACD,GAFD;AAGD,CAJD,CAIE,OAAOC,CAAP,EAAU;AACVR,EAAAA,OAAO,CAACS,KAAR,CAAc,0BAAd;AACAT,EAAAA,OAAO,CAACS,KAAR,CAAcD,CAAd,EAAiBA,CAAC,CAACE,KAAnB;AACApB,EAAAA,OAAO,CAACqB,IAAR,CAAa,CAAb;AACD;;AAEDX,OAAO,CAACC,GAAR,4BAAgCH,YAAhC;AACA,IAAMc,WAAW,GAAG,2CAA0Bd,YAA1B,CAApB;;AAEA,IAAI;AACFO,qBAAOC,QAAP,+BAAuCM,WAAvC,GAAsD;AAAEL,IAAAA,KAAK,EAAE;AAAT,GAAtD;AACD,CAFD,CAEE,OAAOC,CAAP,EAAU;AACVR,EAAAA,OAAO,CAACS,KAAR,CAAc,wBAAd;AACAT,EAAAA,OAAO,CAACS,KAAR,CAAcD,CAAd,EAAiBA,CAAC,CAACE,KAAnB;AACApB,EAAAA,OAAO,CAACqB,IAAR,CAAa,GAAb;AACD","sourcesContent":["#! /usr/bin/env node\n/* eslint no-console: 0 */\n\nimport 'airbnb-js-shims';\n\nimport semver from 'semver';\nimport npmRun from 'npm-run';\nimport getAdapterForReactVersion from './getAdapterForReactVersion';\n\nconst reactEnv = process.env.REACT;\nconst reactArg = process.argv[2];\n\nif (reactEnv && !semver.validRange(reactEnv)) {\n  throw new Error('REACT environment variable is not a valid semver range');\n}\n\nif (reactArg && !semver.validRange(reactArg)) {\n  throw new Error('Argument supplied to enzyme-adapter-react-install is not a valid semver range');\n}\n\nconst reactVersion = reactEnv || reactArg;\n\nif (!semver.intersects(reactVersion, '>=0.13')) {\n  throw new Error('semver range is not valid. Please provide a valid semver range as an argument or environment variable.');\n}\n\nconsole.log('Cleaning up React and related packages...');\nconst commands = [\n  'npm uninstall --no-save react-dom react-test-renderer react-addons-test-utils enzyme-adapter-react-14 enzyme-adapter-react-15.4 enzyme-adapter-react-15 enzyme-adapter-react-16',\n  'rimraf node_modules/react-test-renderer node_modules/react',\n  'npm prune',\n];\n\ntry {\n  commands.forEach((cmd) => {\n    npmRun.execSync(cmd, { stdio: 'inherit' });\n  });\n} catch (e) {\n  console.error('An uninstallation failed');\n  console.error(e, e.stack);\n  process.exit(1);\n}\n\nconsole.log(`Installing React@${reactVersion} and related packages...`);\nconst adapterName = getAdapterForReactVersion(reactVersion);\n\ntry {\n  npmRun.execSync(`install-peerdeps -S ${adapterName}`, { stdio: 'inherit' });\n} catch (e) {\n  console.error('An installation failed');\n  console.error(e, e.stack);\n  process.exit(666);\n}\n"],"file":"enzyme-adapter-react-install.js"}